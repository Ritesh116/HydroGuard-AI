<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydroGuard | Smart City Monitor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <nav class="navbar">
        <div class="logo">
            <i class="fa-solid fa-water"></i> HydroGuard <span style="color:white; font-weight:300;">AI | AMC Distribution Grid</span>
        </div>
        
        <div style="display: flex; align-items: center; gap: 20px;">
            <button onclick="window.open('/report', '_blank')" style="background: #2ea043; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 13px; transition: background 0.3s;" onmouseover="this.style.background='#238636'" onmouseout="this.style.background='#2ea043'">
                <i class="fa-solid fa-file-pdf"></i> Generate Daily Report
            </button>
            <div class="status-indicator" id="system-status">
                <span class="dot"></span> SYSTEM ONLINE
            </div>
        </div>
    </nav>

    <div class="container">
        
        <div class="card map-section">
            <h2>
                <span style="color: #58a6ff; font-weight: bold; font-size: 18px;">HYDROGUARD AI</span> 
                <span style="color: #444;">|</span> Live Geospatial Grid
            </h2>
            <div id="map"></div>
        </div>

        <div class="right-column">
            
            <div class="card stat-card full-width">
                <h3><i class="fa-solid fa-list-check"></i> Zone Status Report</h3>
                <table class="zone-table">
                    <thead>
                        <tr><th>Zone Name</th><th>Pressure</th><th>Status</th></tr>
                    </thead>
                    <tbody id="zone-table-body">
                        </tbody>
                </table>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: white;"><i class="fa-solid fa-chart-line"></i> Live Telemetry Feed</h3>
                <select id="zoneSelect" style="background: #222; color: #00ffcc; border: 1px solid #00ffcc; padding: 5px 10px; border-radius: 4px; font-weight: bold; cursor: pointer;">
                    <option value="ZONE_8">Badnera ESR (Zone 8)</option>
                    <option value="ZONE_1">Maltekdi ESR (Zone 1)</option>
                    <option value="ZONE_2">Navsari ESR (Zone 2)</option>
                    <option value="ZONE_3">VMV ESR (Zone 3)</option>
                    <option value="ZONE_4">Dastur Nagar ESR (Zone 4)</option>
                    <option value="ZONE_5">Rajapeth ESR (Zone 5)</option>
                    <option value="ZONE_6">Sainagar ESR (Zone 6)</option>
                    <option value="ZONE_7">Akoli ESR (Zone 7)</option>
                </select>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <div class="card" style="padding: 15px; background: #151b23; border: 1px solid #30363d; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white; font-size: 14px;">Flow Rate <span style="float: right; font-size: 11px; color: #00ffcc; background: rgba(0,255,204,0.1); padding: 2px 6px; border-radius: 4px;">Live</span></h4>
                    <p style="margin: 0 0 10px 0; font-size: 11px; color: #8b949e;">L/min</p>
                    <div style="position: relative; height: 120px; width: 100%;"><canvas id="flowChart"></canvas></div>
                </div>

                <div class="card" style="padding: 15px; background: #151b23; border: 1px solid #30363d; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white; font-size: 14px;">Pressure <span id="pressure-badge" style="float: right; font-size: 11px; color: #2ea043; background: rgba(46,160,67,0.1); padding: 2px 6px; border-radius: 4px;">Stable</span></h4>
                    <p style="margin: 0 0 10px 0; font-size: 11px; color: #8b949e;">PSI</p>
                    <div style="position: relative; height: 120px; width: 100%;"><canvas id="pressureChart"></canvas></div>
                </div>

                <div class="card" style="padding: 15px; background: #151b23; border: 1px solid #30363d; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white; font-size: 14px;">AI Confidence <span id="confidence-badge" style="float: right; font-size: 11px; color: #2ea043; background: rgba(46,160,67,0.1); padding: 2px 6px; border-radius: 4px;">Nominal</span></h4>
                    <p style="margin: 0 0 10px 0; font-size: 11px; color: #8b949e;">% Probability</p>
                    <div style="position: relative; height: 120px; width: 100%;"><canvas id="confidenceChart"></canvas></div>
                </div>
            </div>

            <div class="card" style="background: #151b23; border: 1px solid #30363d; padding: 20px; border-radius: 8px;">
                <div style="border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: white;"><i class="fa-solid fa-server"></i> Alert & Decision Support</h3>
                    <p style="margin: 5px 0 0 0; font-size: 12px; color: #8b949e;">AI-generated warnings for SCADA operators</p>
                </div>
                
                <div id="alert-log-container" style="max-height: 180px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; padding-right: 5px;">
                    <div style="color: #2ea043; background: rgba(46,160,67,0.1); border: 1px solid #2ea043; padding: 12px; border-radius: 6px; font-size: 14px;">
                        <i class="fa-solid fa-check-circle"></i> System operating within normal parameters. Monitoring all zones.
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>
</html>